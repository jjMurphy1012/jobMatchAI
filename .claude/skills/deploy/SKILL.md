---
name: deploy
description: Deploy application to Railway
disable-model-invocation: true
---

# Railway Deployment Guide

## Pre-deployment Checklist

- [ ] All tests passing
- [ ] Environment variables documented
- [ ] Dockerfile builds successfully
- [ ] No hardcoded secrets in code
- [ ] Database migrations ready

## Environment Variables Required

### Backend
```
OPENAI_API_KEY=sk-xxx
DATABASE_URL=postgresql://...  # Auto-generated by Railway
LINKEDIN_EMAIL=xxx
LINKEDIN_PASSWORD=xxx
SENDGRID_API_KEY=xxx  # Optional, for email
```

### Frontend
```
VITE_API_URL=https://your-backend.up.railway.app
```

## Deployment Steps

### 1. Local Testing with Docker

```bash
# Build and run locally
docker-compose up --build

# Test endpoints
curl http://localhost:8000/health
curl http://localhost:5173
```

### 2. Push to GitHub

```bash
git add .
git commit -m "feat: ready for deployment"
git push origin main
```

### 3. Railway Setup

1. Go to railway.app and create new project
2. Connect GitHub repository
3. Add PostgreSQL database service
4. Configure environment variables
5. Deploy backend service (auto-detects Dockerfile)
6. Deploy frontend service
7. Set up custom domains (optional)

### 4. Database Setup

```bash
# Railway CLI (if installed)
railway run python -c "from app.core.database import init_db; init_db()"

# Or via Railway shell
# Navigate to backend service > Shell tab
python -c "from app.core.database import init_db; init_db()"
```

### 5. Verify Deployment

```bash
# Check backend health
curl https://your-backend.up.railway.app/health

# Check frontend loads
curl https://your-frontend.up.railway.app
```

## Troubleshooting

### Build Fails
- Check Dockerfile syntax
- Verify all dependencies in requirements.txt
- Check Railway build logs

### Database Connection Issues
- Verify DATABASE_URL is set
- Check pgvector extension is enabled
- Railway PostgreSQL includes pgvector by default

### Frontend Can't Reach Backend
- Check VITE_API_URL is correct
- Verify CORS settings in FastAPI
- Check Railway networking

## Rollback

```bash
# Via Railway dashboard
# Deployments > Select previous > Rollback

# Or redeploy specific commit
git revert HEAD
git push origin main
```
